# Copyright (C) Microsoft Corporation. All rights reserved.

trigger:
  branches:
    include:
      - master

pool:
  name: 'SVC'

# Point to another repository for the pipeline template
resources:
  repositories:
    - repository: templates
      type: git
      name: Test Project/Pipelines

variables:
  - group: Pipelines
  
stages:
- stage: list files
  jobs:
  - job : searchpatterns
    steps:
    - bash: ls -ld
- template: etc/pipelines/templates/promote-pipeline-template.yml@templates  # Template reference
  parameters:
    project: 'SiInfra'
    repo_url: 'git@ssh.dev.azure.com:v3/ms-tsd/SiInfra/DVInfra'
    target_branch: 'master'
    legal_header: 'true'
    legal_header_warning: 'true'
    dvlint_audit: 'false'
    verify_pull_request: 'false'
    heimdall_map:
      - quick: 
          [ 
            regr_name: 'quick',
            regr_flags: '--clean keep_7 --no-sync --force-run --wait --wait_seconds 30 --wait_timeout -1  --regr_args skip_forget_vncset:true --flow-args hi_priority:1',
            regr_timeout: '60'
          ]
  